async function feedPage(){var e=window.location.pathname.split("/").slice(-1);"course"==e||"group"==e?(await asideFeedPage(),await courseFeedPage()):"detail"==e&&await courseDetailFeedPage()}function asideFeedPage(){$.ajax({url:local_api+"course/aside",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+access_token},data:JSON.stringify({lang:$("html").attr("lang"),project:$('meta[name="api_project"]').attr("content")})}).done(function(a){if(fail=0,console.log(a),0<a.total){var t=$(".course-new > div.card-main");for(let e=0;e<a.total;e++)0<e&&t.clone().insertAfter(t);i%3==0&&container.append('<div class="row"></div>'),container.find(".row").last().append(clone);var o=site_path+"/course/";for(let e=0;e<a.total;e++)$(".course-new > div.card-main:eq("+e+") h4 > a").text(a.data[e].group_subject),$(".course-new > div.card:eq("+e+") h4 > a").attr("href",o+a.data[e].group_id+"/group")}}).fail(async function(){fail<3&&(await refreshtoken(),await asideFeedPage(),fail++)})}function courseFeedPage(){$.ajax({url:local_api+"course/page",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+access_token},data:JSON.stringify({lang:$("html").attr("lang"),project:$('meta[name="api_project"]').attr("content"),group:course_group,profileID:getCookie("cookieProfileID")||0})}).done(function(a){fail=0;site_path;if(0<a.result){$("h4.heading-subject-text").text(a.group[0].subject),course_group=a.group[0].id;var t=a.data[0].course_data.length,o=$("#course-block > div.course-block-detail");if(0==t)o.remove();else{$("#course-block > div.course-block-zero").remove();for(let e=0;e<t;e++)0<e&&o.clone().insertAfter(o);var r=site_path+"/course/";for(let e=0;e<t;e++){var i=path_validate(a.data[0].course_data[e].cover,location_file),i=($("#course-block > div:eq("+e+") picture > img").attr({src:i,alt:a.data[0].course_data[e].subject}).height(185),$("#course-block > div:eq("+e+") .card-body h2").text(a.data[0].course_data[e].subject),$("#course-block > div:eq("+e+") .card-body var.price").text(a.data[0].course_data[e].price),a.data[0].course_data[e].course_id);$("#course-block > div:eq("+e+") > div.card a").attr("href",r+i+"/detail"),$("#course-block > div:eq("+e+") > div.card .card-footer a").attr("id","course"+i),a.data[0].course_data[e].congratulation<2&&$("#course"+i).text(registered_txt).removeClass("btn-primary-theme").addClass("btn-success").attr("href",site_path+"/lms")}}}else $("#course-block > div.course-block-detail").remove()}).fail(async function(){fail<3&&(await refreshtoken(),await courseFeedPage(),fail++)})}function courseDetailFeedPage(){}function addtofavorites(a){var e=+getCookie("cookieProfileID")||0;0==e?window.location.href=site_path+"/login":$.ajax({url:local_api+"course/favorites",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+access_token},data:JSON.stringify({lang:$("html").attr("lang"),project:$('meta[name="api_project"]').attr("content"),profileID:e,course:a})}).done(function(e){1==e.result?(e=$(".addtofavorites").data("original-title2"),$("#addtofavorites__"+a).addClass("active").attr("title",e)):(e=$(".addtofavorites").data("original-title"),$("#addtofavorites__"+a).removeClass("active").attr("title",e))}).fail(async function(){fail<3&&(await refreshtoken(),await courseFeedPage(),fail++)})}$("#submitCourse").on("click",function(e){e.preventDefault();e=getCookie("cookieProfileID")||0;0==e?window.location.href=site_path+"/login":$.ajax({url:local_api+"course/register",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+access_token},data:JSON.stringify({lang:$("html").attr("lang"),project:$('meta[name="api_project"]').attr("content"),profileID:+e,course:$("#submitCourse").data("id")})}).done(function(e){var a=site_path+"/course/"+$("#submitCourse").data("id")+"/detail/successful";window.location.href=a}).fail(async function(){fail<3&&(await refreshtoken(),await courseFeedPage(),fail++)})});