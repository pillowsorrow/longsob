let fail=0;async function feedPage(){await highlight(),await cours_recommend(),await pop_course(),await link_page(),await news_recommend(),await survey_recommend(),await onlineUser(),$("#rec-course-tab , #pop-course-tab").on("click",function(){$("#rec-course-tab , #pop-course-tab, #rec-course, #pop-course").toggleClass("active"),$("#rec-course, #pop-course").toggleClass("show")})}function highlight(){$.ajax({url:local_api+"web/highlight",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+access_token},data:JSON.stringify({lang:$("html").attr("lang"),project:$('meta[name="api_project"]').attr("content")})}).done(function(a){if((fail=0)<a.total){var t=$("#herobanner > div.js-slide");for(let e=0;e<a.total;e++)0<e&&t.clone().insertAfter(t);for(let e=0;e<a.total;e++){var r=path_validate(a.data[e].banner,location_file);$("#herobanner > div:eq("+e+") ").css("background-image","url('"+r+"')")}$.HSCore.components.HSSlickCarousel.init("#herobanner")}}).fail(async function(){fail<3&&(await refreshtoken(),await highlight(),fail++)})}function link_page(){$.ajax({url:local_api+"web/link",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+access_token},data:JSON.stringify({lang:$("html").attr("lang"),project:$('meta[name="api_project"]').attr("content")})}).done(function(a){if((fail=0)<a.total){var t=$("#linkbanner > div.js-slide");for(let e=0;e<a.total;e++)0<e&&t.clone().insertAfter(t);for(let e=0;e<a.total;e++){var r=path_validate(a.data[e].cover,location_file);$("#linkbanner > div:eq("+e+") img").attr("src",r).attr("alt",a.data[e].links_title).attr("onerror","this.onerror=null;this.src='/images/square-default-logo.png'"),$("#linkbanner > div:eq("+e+") a").attr("href",a.data[e].links)}$.HSCore.components.HSSlickCarousel.init("#linkbanner")}}).fail(async function(){fail<3&&(await refreshtoken(),await link_page(),fail++)})}function cours_recommend(){$.ajax({url:local_api+"course/recommend",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+access_token},data:JSON.stringify({lang:$("html").attr("lang"),project:$('meta[name="api_project"]').attr("content")})}).done(function(a){if((fail=0)<a.total){var t=$("#rec-course > div .card");for(let e=0;e<a.total;e++)0<e&&t.clone().insertAfter(t);var r=site_path+"/course/";for(let e=0;e<a.total;e++){var o=path_validate(a.data[e].cover,location_file);$("#rec-course > div .card:eq("+e+") .card-body h2").text(a.data[e].course_subject),$("#rec-course > div .card:eq("+e+") img").attr("src",o),$("#rec-course > div .card:eq("+e+") .card-body var.price").text(a.data[e].price),$("#rec-course > div .card:eq("+e+") .course-btn a.more").attr("href",r+a.data[e].course_id+"/detail")}$("#rec-course").addClass("active")}else $("#rec-course").hide()}).fail(async function(){fail<3&&(await refreshtoken(),await cours_recommend(),fail++)})}function pop_course(){$.ajax({url:local_api+"course/pop_course",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+access_token},data:JSON.stringify({lang:$("html").attr("lang"),project:$('meta[name="api_project"]').attr("content")})}).done(function(a){if((fail=0)<a.total){var t=$("#pop-course > div .card");for(let e=0;e<a.total;e++)0<e&&t.clone().insertAfter(t);var r=site_path+"course/";for(let e=0;e<a.total;e++){var o=path_validate(a.data[e].cover,location_file);$("#pop-course > div .card:eq("+e+") .card-body h2").text(a.data[e].course_subject),$("#pop-course > div .card:eq("+e+") img").attr("src",o),$("#pop-course > div .card:eq("+e+") .card-body var.price").text(a.data[e].price),$("#pop-course > div .card:eq("+e+") .course-btn a.more").attr("href",r+a.data[e].course_id+"/detail")}}else $("#pop-course").hide()}).fail(async function(){fail<3&&(await refreshtoken(),await pop_course(),fail++)})}function news_recommend(){$.ajax({url:local_api+"news/recommended",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+access_token},data:JSON.stringify({lang:$("html").attr("lang"),project:$('meta[name="api_project"]').attr("content")})}).done(function(a){if((fail=0)<a.total){var t=$("#rec-course4 > div a.card");for(let e=0;e<a.total;e++)0<e&&t.clone().insertAfter(t);var r=site_path+"/news/";for(let e=0;e<a.total;e++){var o=path_validate(a.data[e].cover,location_file);$("#rec-course4 > div a:eq("+e+") .card-body h2").text(a.data[e].web_subject),$("#rec-course4 > div a:eq("+e+") img").attr("src",o),$("#rec-course4 > div a:eq("+e+") ").attr("href",r+"detail/"+a.data[e].web_id+"/"+a.data[e].web_seo)}}else $("#rec-course4").remove()}).fail(async function(){fail<3&&(await refreshtoken(),await news_recommend(),fail++)})}function survey_recommend(){$.ajax({url:local_api+"survey/recommended",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+access_token},data:JSON.stringify({lang:$("html").attr("lang"),project:$('meta[name="api_project"]').attr("content")})}).done(function(a){if((fail=0)<a.total){var t=$("#rec-course3 > div div.media");for(let e=0;e<a.total;e++)0<e&&t.clone().insertAfter(t);var r=site_path+"/survey/assessment/";for(let e=0;e<a.total;e++)$("#rec-course3 > div div.media:eq("+e+") span.btn-icon__inner").text(e+1),$("#rec-course3 > div div.media:eq("+e+") .media-body a").text(a.data[e].survey_subject),$("#rec-course3 > div div.media:eq("+e+") .media-body a").attr("href",r+a.data[e].survey_id);$(".survey-row").css("display","flex"),$(".survey-row").last().css("display","block"),$(".survey-row-no-reult").remove()}else $(".survey-row").remove(),$(".survey-row-no-reult").show()}).fail(async function(){fail<3&&(await refreshtoken(),await survey_recommend(),fail++)})}function onlineUser(){$.ajax({url:local_api+"web/logs",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+access_token},data:JSON.stringify({lang:$("html").attr("lang"),project:$('meta[name="api_project"]').attr("content")})}).done(function(e){fail=0,$("div.counter:eq(0) > h2").text(e.logs_today),$("div.counter:eq(1) > h2").text(e.logs_month),$("div.counter:eq(2) > h2").text(e.logs_all)}).fail(async function(){fail<3&&(await refreshtoken(),await onlineUser(),fail++)})}