async function feedPage(){var e=window.location.pathname.split("/").slice(-1);"course"==e||"group"==e?(await asideFeedPage(),await courseFeedPage()):"detail"==e&&await courseDetailFeedPage()}function asideFeedPage(){$.ajax({url:local_api+"course/aside",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+access_token},data:JSON.stringify({lang:$("html").attr("lang"),project:$('meta[name="api_project"]').attr("content")})}).done(function(t){if(fail=0,console.log(t),0<t.total){var e=$(".pricing"),o=$(".row:first").find(".course-new:first"),r=(e.empty(),Math.min(t.total,9));for(let a=0;a<Math.ceil(r/3);a++){var i=$('<div class="row mt-2"></div>');for(let e=0;e<3;e++){var c=3*a+e;if(r<=c)break;var s=o.clone();s.find("h4 > a").text(t.data[c].group_subject),s.find("h4 > a").attr("href",site_path+"/course/"+t.data[c].group_id+"/group"),i.append(s)}e.append(i)}}}).fail(async function(){fail<3&&(await refreshtoken(),await asideFeedPage(),fail++)})}function courseFeedPage(){$.ajax({url:local_api+"course/page",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+access_token},data:JSON.stringify({lang:$("html").attr("lang"),project:$('meta[name="api_project"]').attr("content"),group:course_group,profileID:getCookie("cookieProfileID")||0})}).done(function(a){fail=0;site_path;if(0<a.result){$("h4.heading-subject-text").text(a.group[0].subject),course_group=a.group[0].id;var t=a.data[0].course_data.length,o=$("#course-choose > div.course-block-detail");if(0==t)o.remove();else{$("#course-choose > div.course-block-zero").remove();for(let e=0;e<t;e++)0<e&&o.clone().insertAfter(o);var r=site_path+"/course/";for(let e=0;e<t;e++){var i=path_validate(a.data[0].course_data[e].cover,location_file),i=($("#course-choose > div:eq("+e+") span > a").attr({src:i,alt:a.data[0].course_data[e].subject}).height(185),$("#course-block > div:eq("+e+") .card-body h2").text(a.data[0].course_data[e].subject),$("#course-block > div:eq("+e+") .card-body var.price").text(a.data[0].course_data[e].price),a.data[0].course_data[e].course_id);$("#course-block > div:eq("+e+") > div.card a").attr("href",r+i+"/detail"),$("#course-block > div:eq("+e+") > div.card .card-footer a").attr("id","course"+i),a.data[0].course_data[e].congratulation<2&&$("#course"+i).text(registered_txt).removeClass("btn-primary-theme").addClass("btn-success").attr("href",site_path+"/lms")}}}else $("#course-block > div.course-block-detail").remove()}).fail(async function(){fail<3&&(await refreshtoken(),await courseFeedPage(),fail++)})}function courseDetailFeedPage(){}function addtofavorites(a){var e=+getCookie("cookieProfileID")||0;0==e?window.location.href=site_path+"/login":$.ajax({url:local_api+"course/favorites",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+access_token},data:JSON.stringify({lang:$("html").attr("lang"),project:$('meta[name="api_project"]').attr("content"),profileID:e,course:a})}).done(function(e){1==e.result?(e=$(".addtofavorites").data("original-title2"),$("#addtofavorites__"+a).addClass("active").attr("title",e)):(e=$(".addtofavorites").data("original-title"),$("#addtofavorites__"+a).removeClass("active").attr("title",e))}).fail(async function(){fail<3&&(await refreshtoken(),await courseFeedPage(),fail++)})}$("#submitCourse").on("click",function(e){e.preventDefault();e=getCookie("cookieProfileID")||0;0==e?window.location.href=site_path+"/login":$.ajax({url:local_api+"course/register",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+access_token},data:JSON.stringify({lang:$("html").attr("lang"),project:$('meta[name="api_project"]').attr("content"),profileID:+e,course:$("#submitCourse").data("id")})}).done(function(e){var a=site_path+"/course/"+$("#submitCourse").data("id")+"/detail/successful";window.location.href=a}).fail(async function(){fail<3&&(await refreshtoken(),await courseFeedPage(),fail++)})});